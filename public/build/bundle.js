var app=function(){"use strict";function e(){}function t(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(t)}function n(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function o(e){e.parentNode.removeChild(e)}let a;function u(e){a=e}const h=[],d=[],l=[],c=[],m=Promise.resolve();let p=!1;function f(e){l.push(e)}let _=!1;const w=new Set;function b(){if(!_){_=!0;do{for(let e=0;e<h.length;e+=1){const t=h[e];u(t),y(t.$$)}for(u(null),h.length=0;d.length;)d.pop()();for(let e=0;e<l.length;e+=1){const t=l[e];w.has(t)||(w.add(t),t())}l.length=0}while(h.length);for(;c.length;)c.pop()();p=!1,_=!1,w.clear()}}function y(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(f)}}const g=new Set;function k(e,t){-1===e.$$.dirty[0]&&(h.push(e),p||(p=!0,m.then(b)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function v(i,h,d,l,c,m,p=[-1]){const _=a;u(i);const w=i.$$={fragment:null,ctx:null,props:m,update:e,not_equal:c,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(_?_.$$.context:h.context||[]),callbacks:r(),dirty:p,skip_bound:!1};let y=!1;if(w.ctx=d?d(i,h.props||{},((e,t,...r)=>{const s=r.length?r[0]:t;return w.ctx&&c(w.ctx[e],w.ctx[e]=s)&&(!w.skip_bound&&w.bound[e]&&w.bound[e](s),y&&k(i,e)),t})):[],w.update(),y=!0,s(w.before_update),w.fragment=!!l&&l(w.ctx),h.target){if(h.hydrate){const e=(S=h.target,Array.from(S.childNodes));w.fragment&&w.fragment.l(e),e.forEach(o)}else w.fragment&&w.fragment.c();h.intro&&((v=i.$$.fragment)&&v.i&&(g.delete(v),v.i(P))),function(e,r,i,o){const{fragment:a,on_mount:u,on_destroy:h,after_update:d}=e.$$;a&&a.m(r,i),o||f((()=>{const r=u.map(t).filter(n);h?h.push(...r):s(r),e.$$.on_mount=[]})),d.forEach(f)}(i,h.target,h.anchor,h.customElement),b()}var v,P,S;u(_)}const P=414,S=736;var x,T,R=Object.create,M=Object.defineProperty,O=Object.getOwnPropertyDescriptor,A=Object.getOwnPropertyNames,C=Object.getOwnPropertySymbols,E=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,N=(e,t,r)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,q=(e,t)=>{for(var r in t||(t={}))I.call(t,r)&&N(e,r,t[r]);if(C)for(var r of C(t))U.call(t,r)&&N(e,r,t[r]);return e},j=(e,t,r)=>new Promise(((s,n)=>{var i=e=>{try{a(r.next(e))}catch(e){n(e)}},o=e=>{try{a(r.throw(e))}catch(e){n(e)}},a=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,o);a((r=r.apply(e,t)).next())}));((e,t,r)=>{r=null!=e?R(E(e)):{},((e,t,r,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of A(t))I.call(e,n)||n===r||M(e,n,{get:()=>t[n],enumerable:!(s=O(t,n))||s.enumerable})})(!t&&e&&e.__esModule?r:M(r,"default",{value:e,enumerable:!0}),e)})((x={"node_modules/whatwg-fetch/fetch.js"(e){!function(e){if(!e.fetch){var t="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,s="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),n="FormData"in e,i="ArrayBuffer"in e;if(i)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},u=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};p.prototype.append=function(e,t){e=l(e),t=c(t);var r=this.map[e];this.map[e]=r?r+","+t:t},p.prototype.delete=function(e){delete this.map[l(e)]},p.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},p.prototype.set=function(e,t){this.map[l(e)]=c(t)},p.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),m(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),m(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),m(e)},r&&(p.prototype[Symbol.iterator]=p.prototype.entries);var h=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},y.call(g.prototype),y.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var d=[301,302,303,307,308];v.redirect=function(e,t){if(-1===d.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=g,e.Response=v,e.fetch=function(e,t){return new Promise((function(r,n){var i=new g(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t,s={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),s=r.shift().trim();if(s){var n=r.join(":").trim();t.append(s,n)}})),t)};s.url="responseURL"in o?o.responseURL:s.headers.get("X-Request-URL");var n="response"in o?o.response:o.responseText;r(new v(n,s))},o.onerror=function(){n(new TypeError("Network request failed"))},o.ontimeout=function(){n(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&s&&(o.responseType="blob"),i.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),o.send(void 0===i._bodyInit?null:i._bodyInit)}))},e.fetch.polyfill=!0}function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function m(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function _(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function w(e){var t=new FileReader,r=_(t);return t.readAsArrayBuffer(e),r}function b(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(s&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(n&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(i&&s&&a(e))this._bodyArrayBuffer=b(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!i||!ArrayBuffer.prototype.isPrototypeOf(e)&&!u(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=b(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(w)}),this.text=function(){var e,t,r,s=f(this);if(s)return s;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=_(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),s=0;s<t.length;s++)r[s]=String.fromCharCode(t[s]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n&&(this.formData=function(){return this.text().then(k)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(e,t){var r,s,n=(t=t||{}).body;if(e instanceof g){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(r=t.method||this.method||"GET",s=r.toUpperCase(),h.indexOf(s)>-1?s:r),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function k(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),s=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(s),decodeURIComponent(n))}})),t}function v(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:e)}},function(){return T||(0,x[A(x)[0]])((T={exports:{}}).exports,T),T.exports})());var F="function"==typeof atob,B="function"==typeof btoa,D="function"==typeof Buffer;"function"==typeof TextDecoder&&new TextDecoder;var z="function"==typeof TextEncoder?new TextEncoder:void 0,G=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],J=(e=>{let t={};return e.forEach(((e,r)=>t[e]=r)),t})(G),$=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,L=String.fromCharCode.bind(String);"function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array);var H=B?e=>btoa(e):D?e=>Buffer.from(e,"binary").toString("base64"):e=>{let t,r,s,n,i="";const o=e.length%3;for(let o=0;o<e.length;){if((r=e.charCodeAt(o++))>255||(s=e.charCodeAt(o++))>255||(n=e.charCodeAt(o++))>255)throw new TypeError("invalid character found");t=r<<16|s<<8|n,i+=G[t>>18&63]+G[t>>12&63]+G[t>>6&63]+G[63&t]}return o?i.slice(0,o-3)+"===".substring(o):i},V=D?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let r=0,s=e.length;r<s;r+=4096)t.push(L.apply(null,e.subarray(r,r+4096)));return H(t.join(""))},X=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?L(192|t>>>6)+L(128|63&t):L(224|t>>>12&15)+L(128|t>>>6&63)+L(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return L(240|t>>>18&7)+L(128|t>>>12&63)+L(128|t>>>6&63)+L(128|63&t)},W=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Z=D?e=>Buffer.from(e,"utf8").toString("base64"):z?e=>V(z.encode(e)):e=>H(e.replace(W,X)),K=(e,t=!1)=>t?(e=>e.replace(/[+\/]/g,(e=>"+"==e?"-":"_")).replace(/=+$/m,""))(Z(e)):Z(e),Y=F?e=>atob(e.replace(/[^A-Za-z0-9\+\/]/g,"")):D?e=>Buffer.from(e,"base64").toString("binary"):e=>{if(e=e.replace(/\s+/g,""),!$.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,r,s,n="";for(let i=0;i<e.length;)t=J[e.charAt(i++)]<<18|J[e.charAt(i++)]<<12|(r=J[e.charAt(i++)])<<6|(s=J[e.charAt(i++)]),n+=64===r?L(t>>16&255):64===s?L(t>>16&255,t>>8&255):L(t>>16&255,t>>8&255,255&t);return n};function Q(e,t,r){const s=q(q({},{method:e}),t);s.headers=q({},t.headers);const n=Object.getOwnPropertyDescriptor(XMLHttpRequest.prototype,"withCredentials");return(null==n?void 0:n.set)||(s.credentials="cocos-ignore"),Object.keys(s.headers).includes("Accept")||(s.headers.Accept="application/json"),Object.keys(s.headers).includes("Content-Type")||(s.headers["Content-Type"]="application/json"),Object.keys(s.headers).forEach((e=>{s.headers[e]||delete s.headers[e]})),r&&(s.body=r),s}var ee,te=class{constructor(e,t,r){this.created=r,this.token=e,this.refresh_token=t,this.created_at=Math.floor((new Date).getTime()/1e3),this.update(e,t)}isexpired(e){return this.expires_at-e<0}isrefreshexpired(e){return this.refresh_expires_at-e<0}update(e,t){const r=e.split(".");if(3!=r.length)throw"jwt is not valid.";const s=JSON.parse(Y(r[1])),n=Math.floor(parseInt(s.exp));if(t){const e=t.split(".");if(3!=e.length)throw"refresh jwt is not valid.";const r=JSON.parse(Y(e[1])),s=Math.floor(parseInt(r.exp));this.refresh_expires_at=s,this.refresh_token=t}this.token=e,this.expires_at=n,this.username=s.usn,this.user_id=s.uid,this.vars=s.vrs}static restore(e,t){return new te(e,t,!1)}},re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",se="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(ee=0;ee<re.length;ee++)se[re.charCodeAt(ee)]=ee;var ne,ie=function(e){var t,r=new Uint8Array(e),s=r.length,n="";for(t=0;t<s;t+=3)n+=re[r[t]>>2],n+=re[(3&r[t])<<4|r[t+1]>>4],n+=re[(15&r[t+1])<<2|r[t+2]>>6],n+=re[63&r[t+2]];return s%3==2?n=n.substring(0,n.length-1)+"=":s%3==1&&(n=n.substring(0,n.length-2)+"=="),n},oe=function(e){var t,r,s,n,i,o=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var h=new ArrayBuffer(o),d=new Uint8Array(h);for(t=0;t<a;t+=4)r=se[e.charCodeAt(t)],s=se[e.charCodeAt(t+1)],n=se[e.charCodeAt(t+2)],i=se[e.charCodeAt(t+3)],d[u++]=r<<2|s>>4,d[u++]=(15&s)<<4|n>>2,d[u++]=(3&n)<<6|63&i;return h},ae=class{constructor(){this._isConnected=!1}get onClose(){return this._socket.onclose}set onClose(e){this._socket.onclose=e}get onError(){return this._socket.onerror}set onError(e){this._socket.onerror=e}get onMessage(){return this._socket.onmessage}set onMessage(e){e?this._socket.onmessage=t=>{const r=JSON.parse(t.data);r.match_data&&r.match_data.data?r.match_data.data=new Uint8Array(oe(r.match_data.data)):r.party_data&&r.party_data.data&&(r.party_data.data=new Uint8Array(oe(r.party_data.data))),e(r)}:e=null}get onOpen(){return this._socket.onopen}set onOpen(e){this._socket.onopen=e}get isConnected(){return this._isConnected}connect(e,t,r,s,n){const i=`${e}${t}:${r}/ws?lang=en&status=${encodeURIComponent(s.toString())}&token=${encodeURIComponent(n)}`;this._socket=new WebSocket(i),this._isConnected=!0}close(){this._isConnected=!1,this._socket.close(),this._socket=void 0}send(e){if(e.match_data_send){e.match_data_send.op_code=e.match_data_send.op_code.toString();let t=e.match_data_send.data;t&&t instanceof Uint8Array?e.match_data_send.data=ie(t.buffer):t&&(e.match_data_send.data=H(t))}else if(e.party_data_send){e.party_data_send.op_code=e.party_data_send.op_code.toString();let t=e.party_data_send.data;t&&t instanceof Uint8Array?e.party_data_send.data=ie(t.buffer):t&&(e.party_data_send.data=H(t))}this._socket.send(JSON.stringify(e))}},ue=new Uint8Array(16);function he(){if(!ne&&!(ne="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ne(ue)}var de=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function le(e){return"string"==typeof e&&de.test(e)}for(var ce=[],me=0;me<256;++me)ce.push((me+256).toString(16).substr(1));function pe(e,t,r){var s=(e=e||{}).random||(e.rng||he)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=s[n];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(ce[e[t+0]]+ce[e[t+1]]+ce[e[t+2]]+ce[e[t+3]]+"-"+ce[e[t+4]]+ce[e[t+5]]+"-"+ce[e[t+6]]+ce[e[t+7]]+"-"+ce[e[t+8]]+ce[e[t+9]]+"-"+ce[e[t+10]]+ce[e[t+11]]+ce[e[t+12]]+ce[e[t+13]]+ce[e[t+14]]+ce[e[t+15]]).toLowerCase();if(!le(r))throw TypeError("Stringified UUID is invalid");return r}(s)}var fe=new class{constructor(){this.client,this.session,this.socket,this.matchID}async authenticate(){this.client=new class{constructor(e="defaultkey",t="127.0.0.1",r="7350",s=!1,n=7e3,i=!0){this.serverkey=e,this.host=t,this.port=r,this.useSSL=s,this.timeout=n,this.autoRefreshSession=i,this.expiredTimespanMs=3e5;const o=`${s?"https://":"http://"}${t}:${r}`;this.apiClient=new class{constructor(e,t,r){this.serverKey=e,this.basePath=t,this.timeoutMs=r}healthcheck(e,t={}){const r=new Map,s=this.buildFullUrl(this.basePath,"/healthcheck",r),n=Q("GET",t,"");return e&&(n.headers.Authorization="Bearer "+e),Promise.race([fetch(s,n).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}getAccount(e,t={}){const r=new Map,s=this.buildFullUrl(this.basePath,"/v2/account",r),n=Q("GET",t,"");return e&&(n.headers.Authorization="Bearer "+e),Promise.race([fetch(s,n).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}updateAccount(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account",s),o=Q("PUT",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}authenticateApple(e,t,r,s,n,i={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const o=new Map;o.set("create",s),o.set("username",n);let a="";a=JSON.stringify(r||{});const u=this.buildFullUrl(this.basePath,"/v2/account/authenticate/apple",o),h=Q("POST",i,a);return h.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}authenticateCustom(e,t,r,s,n,i={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const o=new Map;o.set("create",s),o.set("username",n);let a="";a=JSON.stringify(r||{});const u=this.buildFullUrl(this.basePath,"/v2/account/authenticate/custom",o),h=Q("POST",i,a);return h.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}authenticateDevice(e,t,r,s,n,i={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const o=new Map;o.set("create",s),o.set("username",n);let a="";a=JSON.stringify(r||{});const u=this.buildFullUrl(this.basePath,"/v2/account/authenticate/device",o),h=Q("POST",i,a);return h.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}authenticateEmail(e,t,r,s,n,i={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const o=new Map;o.set("create",s),o.set("username",n);let a="";a=JSON.stringify(r||{});const u=this.buildFullUrl(this.basePath,"/v2/account/authenticate/email",o),h=Q("POST",i,a);return h.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}authenticateFacebook(e,t,r,s,n,i,o={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const a=new Map;a.set("create",s),a.set("username",n),a.set("sync",i);let u="";u=JSON.stringify(r||{});const h=this.buildFullUrl(this.basePath,"/v2/account/authenticate/facebook",a),d=Q("POST",o,u);return d.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(h,d).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}authenticateFacebookInstantGame(e,t,r,s,n,i={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const o=new Map;o.set("create",s),o.set("username",n);let a="";a=JSON.stringify(r||{});const u=this.buildFullUrl(this.basePath,"/v2/account/authenticate/facebookinstantgame",o),h=Q("POST",i,a);return h.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}authenticateGameCenter(e,t,r,s,n,i={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const o=new Map;o.set("create",s),o.set("username",n);let a="";a=JSON.stringify(r||{});const u=this.buildFullUrl(this.basePath,"/v2/account/authenticate/gamecenter",o),h=Q("POST",i,a);return h.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}authenticateGoogle(e,t,r,s,n,i={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const o=new Map;o.set("create",s),o.set("username",n);let a="";a=JSON.stringify(r||{});const u=this.buildFullUrl(this.basePath,"/v2/account/authenticate/google",o),h=Q("POST",i,a);return h.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}authenticateSteam(e,t,r,s,n,i,o={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const a=new Map;a.set("create",s),a.set("username",n),a.set("sync",i);let u="";u=JSON.stringify(r||{});const h=this.buildFullUrl(this.basePath,"/v2/account/authenticate/steam",a),d=Q("POST",o,u);return d.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(h,d).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}linkApple(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/link/apple",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}linkCustom(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/link/custom",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}linkDevice(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/link/device",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}linkEmail(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/link/email",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}linkFacebook(e,t,r,s={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const n=new Map;n.set("sync",r);let i="";i=JSON.stringify(t||{});const o=this.buildFullUrl(this.basePath,"/v2/account/link/facebook",n),a=Q("POST",s,i);return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}linkFacebookInstantGame(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/link/facebookinstantgame",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}linkGameCenter(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/link/gamecenter",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}linkGoogle(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/link/google",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}linkSteam(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/link/steam",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}sessionRefresh(e,t,r,s={}){if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const n=new Map;let i="";i=JSON.stringify(r||{});const o=this.buildFullUrl(this.basePath,"/v2/account/session/refresh",n),a=Q("POST",s,i);return a.headers.Authorization="Basic "+K(e+":"+t),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}unlinkApple(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/unlink/apple",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}unlinkCustom(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/unlink/custom",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}unlinkDevice(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/unlink/device",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}unlinkEmail(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/unlink/email",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}unlinkFacebook(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/unlink/facebook",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}unlinkFacebookInstantGame(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/unlink/facebookinstantgame",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}unlinkGameCenter(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/unlink/gamecenter",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}unlinkGoogle(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/unlink/google",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}unlinkSteam(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/account/unlink/steam",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listChannelMessages(e,t,r,s,n,i={}){if(null==t)throw new Error("'channelId' is a required parameter but is null or undefined.");const o="/v2/channel/{channelId}".replace("{channelId}",encodeURIComponent(String(t))),a=new Map;a.set("limit",r),a.set("forward",s),a.set("cursor",n);const u=this.buildFullUrl(this.basePath,o,a),h=Q("GET",i,"");return e&&(h.headers.Authorization="Bearer "+e),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}event(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/event",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}deleteFriends(e,t,r,s={}){const n=new Map;n.set("ids",t),n.set("usernames",r);const i=this.buildFullUrl(this.basePath,"/v2/friend",n),o=Q("DELETE",s,"");return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listFriends(e,t,r,s,n={}){const i=new Map;i.set("limit",t),i.set("state",r),i.set("cursor",s);const o=this.buildFullUrl(this.basePath,"/v2/friend",i),a=Q("GET",n,"");return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}addFriends(e,t,r,s={}){const n=new Map;n.set("ids",t),n.set("usernames",r);const i=this.buildFullUrl(this.basePath,"/v2/friend",n),o=Q("POST",s,"");return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}blockFriends(e,t,r,s={}){const n=new Map;n.set("ids",t),n.set("usernames",r);const i=this.buildFullUrl(this.basePath,"/v2/friend/block",n),o=Q("POST",s,"");return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}importFacebookFriends(e,t,r,s={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const n=new Map;n.set("reset",r);let i="";i=JSON.stringify(t||{});const o=this.buildFullUrl(this.basePath,"/v2/friend/facebook",n),a=Q("POST",s,i);return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}importSteamFriends(e,t,r,s={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const n=new Map;n.set("reset",r);let i="";i=JSON.stringify(t||{});const o=this.buildFullUrl(this.basePath,"/v2/friend/steam",n),a=Q("POST",s,i);return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listGroups(e,t,r,s,n,i,o,a={}){const u=new Map;u.set("name",t),u.set("cursor",r),u.set("limit",s),u.set("lang_tag",n),u.set("members",i),u.set("open",o);const h=this.buildFullUrl(this.basePath,"/v2/group",u),d=Q("GET",a,"");return e&&(d.headers.Authorization="Bearer "+e),Promise.race([fetch(h,d).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}createGroup(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/group",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}deleteGroup(e,t,r={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");const s="/v2/group/{groupId}".replace("{groupId}",encodeURIComponent(String(t))),n=new Map,i=this.buildFullUrl(this.basePath,s,n),o=Q("DELETE",r,"");return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}updateGroup(e,t,r,s={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const n="/v2/group/{groupId}".replace("{groupId}",encodeURIComponent(String(t))),i=new Map;let o="";o=JSON.stringify(r||{});const a=this.buildFullUrl(this.basePath,n,i),u=Q("PUT",s,o);return e&&(u.headers.Authorization="Bearer "+e),Promise.race([fetch(a,u).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}addGroupUsers(e,t,r,s={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");const n="/v2/group/{groupId}/add".replace("{groupId}",encodeURIComponent(String(t))),i=new Map;i.set("user_ids",r);const o=this.buildFullUrl(this.basePath,n,i),a=Q("POST",s,"");return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}banGroupUsers(e,t,r,s={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");const n="/v2/group/{groupId}/ban".replace("{groupId}",encodeURIComponent(String(t))),i=new Map;i.set("user_ids",r);const o=this.buildFullUrl(this.basePath,n,i),a=Q("POST",s,"");return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}demoteGroupUsers(e,t,r,s={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");if(null==r)throw new Error("'userIds' is a required parameter but is null or undefined.");const n="/v2/group/{groupId}/demote".replace("{groupId}",encodeURIComponent(String(t))),i=new Map;i.set("user_ids",r);const o=this.buildFullUrl(this.basePath,n,i),a=Q("POST",s,"");return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}joinGroup(e,t,r={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");const s="/v2/group/{groupId}/join".replace("{groupId}",encodeURIComponent(String(t))),n=new Map,i=this.buildFullUrl(this.basePath,s,n),o=Q("POST",r,"");return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}kickGroupUsers(e,t,r,s={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");const n="/v2/group/{groupId}/kick".replace("{groupId}",encodeURIComponent(String(t))),i=new Map;i.set("user_ids",r);const o=this.buildFullUrl(this.basePath,n,i),a=Q("POST",s,"");return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}leaveGroup(e,t,r={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");const s="/v2/group/{groupId}/leave".replace("{groupId}",encodeURIComponent(String(t))),n=new Map,i=this.buildFullUrl(this.basePath,s,n),o=Q("POST",r,"");return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}promoteGroupUsers(e,t,r,s={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");const n="/v2/group/{groupId}/promote".replace("{groupId}",encodeURIComponent(String(t))),i=new Map;i.set("user_ids",r);const o=this.buildFullUrl(this.basePath,n,i),a=Q("POST",s,"");return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listGroupUsers(e,t,r,s,n,i={}){if(null==t)throw new Error("'groupId' is a required parameter but is null or undefined.");const o="/v2/group/{groupId}/user".replace("{groupId}",encodeURIComponent(String(t))),a=new Map;a.set("limit",r),a.set("state",s),a.set("cursor",n);const u=this.buildFullUrl(this.basePath,o,a),h=Q("GET",i,"");return e&&(h.headers.Authorization="Bearer "+e),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}validatePurchaseApple(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/iap/purchase/apple",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}validatePurchaseGoogle(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/iap/purchase/google",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}validatePurchaseHuawei(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/iap/purchase/huawei",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}deleteLeaderboardRecord(e,t,r={}){if(null==t)throw new Error("'leaderboardId' is a required parameter but is null or undefined.");const s="/v2/leaderboard/{leaderboardId}".replace("{leaderboardId}",encodeURIComponent(String(t))),n=new Map,i=this.buildFullUrl(this.basePath,s,n),o=Q("DELETE",r,"");return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listLeaderboardRecords(e,t,r,s,n,i,o={}){if(null==t)throw new Error("'leaderboardId' is a required parameter but is null or undefined.");const a="/v2/leaderboard/{leaderboardId}".replace("{leaderboardId}",encodeURIComponent(String(t))),u=new Map;u.set("owner_ids",r),u.set("limit",s),u.set("cursor",n),u.set("expiry",i);const h=this.buildFullUrl(this.basePath,a,u),d=Q("GET",o,"");return e&&(d.headers.Authorization="Bearer "+e),Promise.race([fetch(h,d).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}writeLeaderboardRecord(e,t,r,s={}){if(null==t)throw new Error("'leaderboardId' is a required parameter but is null or undefined.");if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const n="/v2/leaderboard/{leaderboardId}".replace("{leaderboardId}",encodeURIComponent(String(t))),i=new Map;let o="";o=JSON.stringify(r||{});const a=this.buildFullUrl(this.basePath,n,i),u=Q("POST",s,o);return e&&(u.headers.Authorization="Bearer "+e),Promise.race([fetch(a,u).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listLeaderboardRecordsAroundOwner(e,t,r,s,n,i={}){if(null==t)throw new Error("'leaderboardId' is a required parameter but is null or undefined.");if(null==r)throw new Error("'ownerId' is a required parameter but is null or undefined.");const o="/v2/leaderboard/{leaderboardId}/owner/{ownerId}".replace("{leaderboardId}",encodeURIComponent(String(t))).replace("{ownerId}",encodeURIComponent(String(r))),a=new Map;a.set("limit",s),a.set("expiry",n);const u=this.buildFullUrl(this.basePath,o,a),h=Q("GET",i,"");return e&&(h.headers.Authorization="Bearer "+e),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listMatches(e,t,r,s,n,i,o,a={}){const u=new Map;u.set("limit",t),u.set("authoritative",r),u.set("label",s),u.set("min_size",n),u.set("max_size",i),u.set("query",o);const h=this.buildFullUrl(this.basePath,"/v2/match",u),d=Q("GET",a,"");return e&&(d.headers.Authorization="Bearer "+e),Promise.race([fetch(h,d).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}deleteNotifications(e,t,r={}){const s=new Map;s.set("ids",t);const n=this.buildFullUrl(this.basePath,"/v2/notification",s),i=Q("DELETE",r,"");return e&&(i.headers.Authorization="Bearer "+e),Promise.race([fetch(n,i).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listNotifications(e,t,r,s={}){const n=new Map;n.set("limit",t),n.set("cacheable_cursor",r);const i=this.buildFullUrl(this.basePath,"/v2/notification",n),o=Q("GET",s,"");return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}rpcFunc2(e,t,r,s,n={}){if(null==t)throw new Error("'id' is a required parameter but is null or undefined.");const i="/v2/rpc/{id}".replace("{id}",encodeURIComponent(String(t))),o=new Map;o.set("payload",r),o.set("http_key",s);const a=this.buildFullUrl(this.basePath,i,o),u=Q("GET",n,"");return e&&(u.headers.Authorization="Bearer "+e),Promise.race([fetch(a,u).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}rpcFunc(e,t,r,s,n={}){if(null==t)throw new Error("'id' is a required parameter but is null or undefined.");if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const i="/v2/rpc/{id}".replace("{id}",encodeURIComponent(String(t))),o=new Map;o.set("http_key",s);let a="";a=JSON.stringify(r||{});const u=this.buildFullUrl(this.basePath,i,o),h=Q("POST",n,a);return e&&(h.headers.Authorization="Bearer "+e),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}sessionLogout(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/session/logout",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}readStorageObjects(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/storage",s),o=Q("POST",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}writeStorageObjects(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/storage",s),o=Q("PUT",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}deleteStorageObjects(e,t,r={}){if(null==t)throw new Error("'body' is a required parameter but is null or undefined.");const s=new Map;let n="";n=JSON.stringify(t||{});const i=this.buildFullUrl(this.basePath,"/v2/storage/delete",s),o=Q("PUT",r,n);return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listStorageObjects(e,t,r,s,n,i={}){if(null==t)throw new Error("'collection' is a required parameter but is null or undefined.");const o="/v2/storage/{collection}".replace("{collection}",encodeURIComponent(String(t))),a=new Map;a.set("user_id",r),a.set("limit",s),a.set("cursor",n);const u=this.buildFullUrl(this.basePath,o,a),h=Q("GET",i,"");return e&&(h.headers.Authorization="Bearer "+e),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listStorageObjects2(e,t,r,s,n,i={}){if(null==t)throw new Error("'collection' is a required parameter but is null or undefined.");if(null==r)throw new Error("'userId' is a required parameter but is null or undefined.");const o="/v2/storage/{collection}/{userId}".replace("{collection}",encodeURIComponent(String(t))).replace("{userId}",encodeURIComponent(String(r))),a=new Map;a.set("limit",s),a.set("cursor",n);const u=this.buildFullUrl(this.basePath,o,a),h=Q("GET",i,"");return e&&(h.headers.Authorization="Bearer "+e),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listTournaments(e,t,r,s,n,i,o,a={}){const u=new Map;u.set("category_start",t),u.set("category_end",r),u.set("start_time",s),u.set("end_time",n),u.set("limit",i),u.set("cursor",o);const h=this.buildFullUrl(this.basePath,"/v2/tournament",u),d=Q("GET",a,"");return e&&(d.headers.Authorization="Bearer "+e),Promise.race([fetch(h,d).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listTournamentRecords(e,t,r,s,n,i,o={}){if(null==t)throw new Error("'tournamentId' is a required parameter but is null or undefined.");const a="/v2/tournament/{tournamentId}".replace("{tournamentId}",encodeURIComponent(String(t))),u=new Map;u.set("owner_ids",r),u.set("limit",s),u.set("cursor",n),u.set("expiry",i);const h=this.buildFullUrl(this.basePath,a,u),d=Q("GET",o,"");return e&&(d.headers.Authorization="Bearer "+e),Promise.race([fetch(h,d).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}writeTournamentRecord2(e,t,r,s={}){if(null==t)throw new Error("'tournamentId' is a required parameter but is null or undefined.");if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const n="/v2/tournament/{tournamentId}".replace("{tournamentId}",encodeURIComponent(String(t))),i=new Map;let o="";o=JSON.stringify(r||{});const a=this.buildFullUrl(this.basePath,n,i),u=Q("POST",s,o);return e&&(u.headers.Authorization="Bearer "+e),Promise.race([fetch(a,u).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}writeTournamentRecord(e,t,r,s={}){if(null==t)throw new Error("'tournamentId' is a required parameter but is null or undefined.");if(null==r)throw new Error("'body' is a required parameter but is null or undefined.");const n="/v2/tournament/{tournamentId}".replace("{tournamentId}",encodeURIComponent(String(t))),i=new Map;let o="";o=JSON.stringify(r||{});const a=this.buildFullUrl(this.basePath,n,i),u=Q("PUT",s,o);return e&&(u.headers.Authorization="Bearer "+e),Promise.race([fetch(a,u).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}joinTournament(e,t,r={}){if(null==t)throw new Error("'tournamentId' is a required parameter but is null or undefined.");const s="/v2/tournament/{tournamentId}/join".replace("{tournamentId}",encodeURIComponent(String(t))),n=new Map,i=this.buildFullUrl(this.basePath,s,n),o=Q("POST",r,"");return e&&(o.headers.Authorization="Bearer "+e),Promise.race([fetch(i,o).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listTournamentRecordsAroundOwner(e,t,r,s,n,i={}){if(null==t)throw new Error("'tournamentId' is a required parameter but is null or undefined.");if(null==r)throw new Error("'ownerId' is a required parameter but is null or undefined.");const o="/v2/tournament/{tournamentId}/owner/{ownerId}".replace("{tournamentId}",encodeURIComponent(String(t))).replace("{ownerId}",encodeURIComponent(String(r))),a=new Map;a.set("limit",s),a.set("expiry",n);const u=this.buildFullUrl(this.basePath,o,a),h=Q("GET",i,"");return e&&(h.headers.Authorization="Bearer "+e),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}getUsers(e,t,r,s,n={}){const i=new Map;i.set("ids",t),i.set("usernames",r),i.set("facebook_ids",s);const o=this.buildFullUrl(this.basePath,"/v2/user",i),a=Q("GET",n,"");return e&&(a.headers.Authorization="Bearer "+e),Promise.race([fetch(o,a).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}listUserGroups(e,t,r,s,n,i={}){if(null==t)throw new Error("'userId' is a required parameter but is null or undefined.");const o="/v2/user/{userId}/group".replace("{userId}",encodeURIComponent(String(t))),a=new Map;a.set("limit",r),a.set("state",s),a.set("cursor",n);const u=this.buildFullUrl(this.basePath,o,a),h=Q("GET",i,"");return e&&(h.headers.Authorization="Bearer "+e),Promise.race([fetch(u,h).then((e=>{if(204==e.status)return e;if(e.status>=200&&e.status<300)return e.json();throw e})),new Promise(((e,t)=>setTimeout(t,this.timeoutMs,"Request timed out.")))])}buildFullUrl(e,t,r){let s=e+t+"?";for(let[e,t]of r)t instanceof Array?s+=t.reduce(((t,r)=>t+encodeURIComponent(e)+"="+encodeURIComponent(r)+"&"),""):null!=t&&(s+=encodeURIComponent(e)+"="+encodeURIComponent(t)+"&");return s}}(e,o,n)}addGroupUsers(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.addGroupUsers(e.token,t,r).then((e=>void 0!==e))}))}addFriends(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.addFriends(e.token,t,r).then((e=>void 0!==e))}))}authenticateApple(e,t,r){return j(this,arguments,(function*(e,t,r,s={},n={}){const i={token:e,vars:s};return this.apiClient.authenticateApple(this.serverkey,"",i,t,r,n).then((e=>new te(e.token||"",e.refresh_token||"",e.created||!1)))}))}authenticateCustom(e,t,r,s={},n={}){const i={id:e,vars:s};return this.apiClient.authenticateCustom(this.serverkey,"",i,t,r,n).then((e=>new te(e.token||"",e.refresh_token||"",e.created||!1)))}authenticateDevice(e,t,r,s){const n={id:e,vars:s};return this.apiClient.authenticateDevice(this.serverkey,"",n,t,r).then((e=>new te(e.token||"",e.refresh_token||"",e.created||!1)))}authenticateEmail(e,t,r,s,n){const i={email:e,password:t,vars:n};return this.apiClient.authenticateEmail(this.serverkey,"",i,r,s).then((e=>new te(e.token||"",e.refresh_token||"",e.created||!1)))}authenticateFacebookInstantGame(e,t,r,s,n={}){const i={signed_player_info:e,vars:s};return this.apiClient.authenticateFacebookInstantGame(this.serverkey,"",{signed_player_info:i.signed_player_info,vars:i.vars},t,r,n).then((e=>new te(e.token||"",e.refresh_token||"",e.created||!1)))}authenticateFacebook(e,t,r,s,n,i={}){const o={token:e,vars:n};return this.apiClient.authenticateFacebook(this.serverkey,"",o,t,r,s,i).then((e=>new te(e.token||"",e.refresh_token||"",e.created||!1)))}authenticateGoogle(e,t,r,s,n={}){const i={token:e,vars:s};return this.apiClient.authenticateGoogle(this.serverkey,"",i,t,r,n).then((e=>new te(e.token||"",e.refresh_token||"",e.created||!1)))}authenticateGameCenter(e,t,r,s){const n={token:e,vars:s};return this.apiClient.authenticateGameCenter(this.serverkey,"",n,t,r).then((e=>new te(e.token||"",e.refresh_token||"",e.created||!1)))}authenticateSteam(e,t,r,s,n){return j(this,null,(function*(){const i={token:e,vars:n,sync:s};return this.apiClient.authenticateSteam(this.serverkey,"",i,t,r).then((e=>new te(e.token||"",e.refresh_token||"",e.created||!1)))}))}banGroupUsers(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.banGroupUsers(e.token,t,r).then((e=>void 0!==e))}))}blockFriends(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.blockFriends(e.token,t,r).then((e=>Promise.resolve(null!=e)))}))}createGroup(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.createGroup(e.token,t).then((e=>Promise.resolve({avatar_url:e.avatar_url,create_time:e.create_time,creator_id:e.creator_id,description:e.description,edge_count:e.edge_count?Number(e.edge_count):0,id:e.id,lang_tag:e.lang_tag,max_count:e.max_count?Number(e.max_count):0,metadata:e.metadata?JSON.parse(e.metadata):void 0,name:e.name,open:e.open,update_time:e.update_time})))}))}createSocket(e=!1,t=!1,r=new ae){return new class{constructor(e,t,r=!1,s=!1,n=new ae){this.host=e,this.port=t,this.useSSL=r,this.verbose=s,this.adapter=n,this.cIds={},this.nextCid=1}generatecid(){const e=this.nextCid.toString();return++this.nextCid,e}connect(e,t=!1){if(this.adapter.isConnected)return Promise.resolve(e);const r=this.useSSL?"wss://":"ws://";return this.adapter.connect(r,this.host,this.port,t,e.token),this.adapter.onClose=e=>{this.ondisconnect(e)},this.adapter.onError=e=>{this.onerror(e)},this.adapter.onMessage=e=>{if(this.verbose&&window&&window.console&&console.log("Response: %o",JSON.stringify(e)),e.cid){const t=this.cIds[e.cid];if(!t)return void(this.verbose&&window&&window.console&&console.error("No promise executor for message: %o",e));delete this.cIds[e.cid],e.error?t.reject(e.error):t.resolve(e)}else e.notifications?e.notifications.notifications.forEach((e=>{e.content=e.content?JSON.parse(e.content):void 0,this.onnotification(e)})):e.match_data?(e.match_data.op_code=parseInt(e.match_data.op_code),this.onmatchdata(e.match_data)):e.match_presence_event?this.onmatchpresence(e.match_presence_event):e.matchmaker_ticket?this.onmatchmakerticket(e.matchmaker_ticket):e.matchmaker_matched?this.onmatchmakermatched(e.matchmaker_matched):e.status_presence_event?this.onstatuspresence(e.status_presence_event):e.stream_presence_event?this.onstreampresence(e.stream_presence_event):e.stream_data?this.onstreamdata(e.stream_data):e.channel_message?(e.channel_message.content=JSON.parse(e.channel_message.content),this.onchannelmessage(e.channel_message)):e.channel_presence_event?this.onchannelpresence(e.channel_presence_event):e.party_data?(e.party_data.op_code=parseInt(e.party_data.op_code),this.onpartydata(e.party_data)):e.on_party_close?this.onpartyclose():e.party_join_request?this.onpartyjoinrequest(e.party_join_request):e.party_leader?this.onpartyleader(e.party_leader):e.party_matchmaker_ticket?this.onpartymatchmakerticket(e.party_matchmaker_ticket):e.party_presence_event?this.onpartypresence(e.party_presence_event):e.party?this.onparty(e.party):this.verbose&&window&&window.console&&console.log("Unrecognized message received: %o",e)},new Promise(((t,r)=>{this.adapter.onOpen=r=>{this.verbose&&window&&window.console&&console.log(r),t(e)},this.adapter.onError=e=>{r(e),this.adapter.close()}}))}disconnect(e=!0){this.adapter.isConnected&&this.adapter.close(),e&&this.ondisconnect({})}ondisconnect(e){this.verbose&&window&&window.console&&console.log(e)}onerror(e){this.verbose&&window&&window.console&&console.log(e)}onchannelmessage(e){this.verbose&&window&&window.console&&console.log(e)}onchannelpresence(e){this.verbose&&window&&window.console&&console.log(e)}onnotification(e){this.verbose&&window&&window.console&&console.log(e)}onmatchdata(e){this.verbose&&window&&window.console&&console.log(e)}onmatchpresence(e){this.verbose&&window&&window.console&&console.log(e)}onmatchmakerticket(e){this.verbose&&window&&window.console&&console.log(e)}onmatchmakermatched(e){this.verbose&&window&&window.console&&console.log(e)}onparty(e){this.verbose&&window&&window.console&&console.log(e)}onpartyclose(){this.verbose&&window&&window.console&&console.log("Party closed.")}onpartyjoinrequest(e){this.verbose&&window&&window.console&&console.log(e)}onpartydata(e){this.verbose&&window&&window.console&&console.log(e)}onpartyleader(e){this.verbose&&window&&window.console&&console.log(e)}onpartymatchmakerticket(e){this.verbose&&window&&window.console&&console.log(e)}onpartypresence(e){this.verbose&&window&&window.console&&console.log(e)}onstatuspresence(e){this.verbose&&window&&window.console&&console.log(e)}onstreampresence(e){this.verbose&&window&&window.console&&console.log(e)}onstreamdata(e){this.verbose&&window&&window.console&&console.log(e)}send(e){const t=e;return new Promise(((e,r)=>{if(this.adapter.isConnected)if(t.match_data_send)this.adapter.send(t),e();else if(t.party_data_send)this.adapter.send(t),e();else{t.channel_message_send?t.channel_message_send.content=JSON.stringify(t.channel_message_send.content):t.channel_message_update&&(t.channel_message_update.content=JSON.stringify(t.channel_message_update.content));const s=this.generatecid();this.cIds[s]={resolve:e,reject:r},t.cid=s,this.adapter.send(t)}else r("Socket connection has not been established yet.");this.verbose&&window&&window.console&&console.log("Sent message: %o",JSON.stringify(t))}))}acceptPartyMember(e,t){return this.send({party_accept:{party_id:e,presence:t}})}addMatchmaker(e,t,r,s,n){return j(this,null,(function*(){return(yield this.send({matchmaker_add:{min_count:t,max_count:r,query:e,string_properties:s,numeric_properties:n}})).matchmaker_ticket}))}addMatchmakerParty(e,t,r,s,n,i){return j(this,null,(function*(){return(yield this.send({party_matchmaker_add:{party_id:e,min_count:r,max_count:s,query:t,string_properties:n,numeric_properties:i}})).party_matchmaker_ticket}))}closeParty(e){return j(this,null,(function*(){return yield this.send({party_close:{party_id:e}})}))}createMatch(){return j(this,null,(function*(){return(yield this.send({match_create:{}})).match}))}createParty(e,t){return j(this,null,(function*(){return(yield this.send({party_create:{open:e,max_size:t}})).party}))}followUsers(e){return j(this,null,(function*(){return(yield this.send({status_follow:{user_ids:e}})).status}))}joinChat(e,t,r,s){return j(this,null,(function*(){return(yield this.send({channel_join:{target:e,type:t,persistence:r,hidden:s}})).channel}))}joinMatch(e,t,r){return j(this,null,(function*(){const s={match_join:{metadata:r}};return t?s.match_join.token=t:s.match_join.match_id=e,(yield this.send(s)).match}))}joinParty(e){return j(this,null,(function*(){return yield this.send({party_join:{party_id:e}})}))}leaveChat(e){return this.send({channel_leave:{channel_id:e}})}leaveMatch(e){return this.send({match_leave:{match_id:e}})}leaveParty(e){return this.send({party_leave:{party_id:e}})}listPartyJoinRequests(e){return j(this,null,(function*(){return(yield this.send({party_join_request_list:{party_id:e}})).party_join_request}))}promotePartyMember(e,t){return j(this,null,(function*(){return(yield this.send({party_promote:{party_id:e,presence:t}})).party_leader}))}removeChatMessage(e,t){return j(this,null,(function*(){return(yield this.send({channel_message_remove:{channel_id:e,message_id:t}})).channel_message_ack}))}removeMatchmaker(e){return this.send({matchmaker_remove:{ticket:e}})}removeMatchmakerParty(e,t){return this.send({party_matchmaker_remove:{party_id:e,ticket:t}})}removePartyMember(e,t){return j(this,null,(function*(){return this.send({party_remove:{party_id:e,presence:t}})}))}rpc(e,t,r){return j(this,null,(function*(){return(yield this.send({rpc:{id:e,payload:t,http_key:r}})).rpc}))}sendMatchState(e,t,r,s,n){return j(this,null,(function*(){return this.send({match_data_send:{match_id:e,op_code:t,data:r,presences:null!=s?s:[],reliable:n}})}))}sendPartyData(e,t,r){return this.send({party_data_send:{party_id:e,op_code:t,data:r}})}unfollowUsers(e){return this.send({status_unfollow:{user_ids:e}})}updateChatMessage(e,t,r){return j(this,null,(function*(){return(yield this.send({channel_message_update:{channel_id:e,message_id:t,content:r}})).channel_message_ack}))}updateStatus(e){return this.send({status_update:{status:e}})}writeChatMessage(e,t){return j(this,null,(function*(){return(yield this.send({channel_message_send:{channel_id:e,content:t}})).channel_message_ack}))}}(this.host,this.port,e,t,r)}deleteFriends(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.deleteFriends(e.token,t,r).then((e=>void 0!==e))}))}deleteGroup(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.deleteGroup(e.token,t).then((e=>void 0!==e))}))}deleteNotifications(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.deleteNotifications(e.token,t).then((e=>Promise.resolve(null!=e)))}))}deleteStorageObjects(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.deleteStorageObjects(e.token,t).then((e=>Promise.resolve(null!=e)))}))}demoteGroupUsers(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.demoteGroupUsers(e.token,t,r).then((e=>Promise.resolve(null!=e)))}))}emitEvent(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.event(e.token,t).then((e=>Promise.resolve(null!=e)))}))}getAccount(e){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.getAccount(e.token)}))}importFacebookFriends(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.importFacebookFriends(e.token,t).then((e=>void 0!==e))}))}importSteamFriends(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.importSteamFriends(e.token,t,r).then((e=>void 0!==e))}))}getUsers(e,t,r,s){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.getUsers(e.token,t,r,s).then((e=>{var t={users:[]};return null==e.users||e.users.forEach((e=>{t.users.push({avatar_url:e.avatar_url,create_time:e.create_time,display_name:e.display_name,edge_count:e.edge_count?Number(e.edge_count):0,facebook_id:e.facebook_id,gamecenter_id:e.gamecenter_id,google_id:e.google_id,id:e.id,lang_tag:e.lang_tag,location:e.location,online:e.online,steam_id:e.steam_id,timezone:e.timezone,update_time:e.update_time,username:e.username,metadata:e.metadata?JSON.parse(e.metadata):void 0})})),Promise.resolve(t)}))}))}joinGroup(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.joinGroup(e.token,t,{}).then((e=>void 0!==e))}))}joinTournament(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.joinTournament(e.token,t,{}).then((e=>void 0!==e))}))}kickGroupUsers(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.kickGroupUsers(e.token,t,r).then((e=>Promise.resolve(null!=e)))}))}leaveGroup(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.leaveGroup(e.token,t,{}).then((e=>void 0!==e))}))}listChannelMessages(e,t,r,s,n){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listChannelMessages(e.token,t,r,s,n).then((e=>{var t={messages:[],next_cursor:e.next_cursor,prev_cursor:e.prev_cursor,cacheable_cursor:e.cacheable_cursor};return null==e.messages||e.messages.forEach((e=>{t.messages.push({channel_id:e.channel_id,code:e.code?Number(e.code):0,create_time:e.create_time,message_id:e.message_id,persistent:e.persistent,sender_id:e.sender_id,update_time:e.update_time,username:e.username,content:e.content?JSON.parse(e.content):void 0,group_id:e.group_id,room_name:e.room_name,user_id_one:e.user_id_one,user_id_two:e.user_id_two})})),Promise.resolve(t)}))}))}listGroupUsers(e,t,r,s,n){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listGroupUsers(e.token,t,s,r,n).then((e=>{var t={group_users:[],cursor:e.cursor};return null==e.group_users||e.group_users.forEach((e=>{t.group_users.push({user:{avatar_url:e.user.avatar_url,create_time:e.user.create_time,display_name:e.user.display_name,edge_count:e.user.edge_count?Number(e.user.edge_count):0,facebook_id:e.user.facebook_id,gamecenter_id:e.user.gamecenter_id,google_id:e.user.google_id,id:e.user.id,lang_tag:e.user.lang_tag,location:e.user.location,online:e.user.online,steam_id:e.user.steam_id,timezone:e.user.timezone,update_time:e.user.update_time,username:e.user.username,metadata:e.user.metadata?JSON.parse(e.user.metadata):void 0},state:e.state?Number(e.state):0})})),Promise.resolve(t)}))}))}listUserGroups(e,t,r,s,n){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listUserGroups(e.token,t,r,s,n).then((e=>{var t={user_groups:[],cursor:e.cursor};return null==e.user_groups||e.user_groups.forEach((e=>{t.user_groups.push({group:{avatar_url:e.group.avatar_url,create_time:e.group.create_time,creator_id:e.group.creator_id,description:e.group.description,edge_count:e.group.edge_count?Number(e.group.edge_count):0,id:e.group.id,lang_tag:e.group.lang_tag,max_count:e.group.max_count,metadata:e.group.metadata?JSON.parse(e.group.metadata):void 0,name:e.group.name,open:e.group.open,update_time:e.group.update_time},state:e.state?Number(e.state):0})})),Promise.resolve(t)}))}))}listGroups(e,t,r,s){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listGroups(e.token,t,r,s).then((e=>{var t={groups:[]};return null==e.groups||(t.cursor=e.cursor,e.groups.forEach((e=>{t.groups.push({avatar_url:e.avatar_url,create_time:e.create_time,creator_id:e.creator_id,description:e.description,edge_count:e.edge_count?Number(e.edge_count):0,id:e.id,lang_tag:e.lang_tag,max_count:e.max_count,metadata:e.metadata?JSON.parse(e.metadata):void 0,name:e.name,open:e.open,update_time:e.update_time})}))),Promise.resolve(t)}))}))}linkApple(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.linkApple(e.token,t).then((e=>void 0!==e))}))}linkCustom(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.linkCustom(e.token,t).then((e=>void 0!==e))}))}linkDevice(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.linkDevice(e.token,t).then((e=>void 0!==e))}))}linkEmail(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.linkEmail(e.token,t).then((e=>void 0!==e))}))}linkFacebook(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.linkFacebook(e.token,t).then((e=>void 0!==e))}))}linkFacebookInstantGame(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.linkFacebookInstantGame(e.token,t).then((e=>void 0!==e))}))}linkGoogle(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.linkGoogle(e.token,t).then((e=>void 0!==e))}))}linkGameCenter(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.linkGameCenter(e.token,t).then((e=>void 0!==e))}))}linkSteam(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.linkSteam(e.token,t).then((e=>void 0!==e))}))}listFriends(e,t,r,s){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listFriends(e.token,r,t,s).then((e=>{var t={friends:[],cursor:e.cursor};return null==e.friends||e.friends.forEach((e=>{t.friends.push({user:{avatar_url:e.user.avatar_url,create_time:e.user.create_time,display_name:e.user.display_name,edge_count:e.user.edge_count?Number(e.user.edge_count):0,facebook_id:e.user.facebook_id,gamecenter_id:e.user.gamecenter_id,google_id:e.user.google_id,id:e.user.id,lang_tag:e.user.lang_tag,location:e.user.location,online:e.user.online,steam_id:e.user.steam_id,timezone:e.user.timezone,update_time:e.user.update_time,username:e.user.username,metadata:e.user.metadata?JSON.parse(e.user.metadata):void 0,facebook_instant_game_id:e.user.facebook_instant_game_id},state:e.state})})),Promise.resolve(t)}))}))}listLeaderboardRecords(e,t,r,s,n,i){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listLeaderboardRecords(e.token,t,r,s,n,i).then((e=>{var t={next_cursor:e.next_cursor,prev_cursor:e.prev_cursor,owner_records:[],records:[]};return null!=e.owner_records&&e.owner_records.forEach((e=>{t.owner_records.push({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,rank:e.rank?Number(e.rank):0,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0})})),null!=e.records&&e.records.forEach((e=>{t.records.push({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,rank:e.rank?Number(e.rank):0,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0})})),Promise.resolve(t)}))}))}listLeaderboardRecordsAroundOwner(e,t,r,s,n){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listLeaderboardRecordsAroundOwner(e.token,t,r,s,n).then((e=>{var t={next_cursor:e.next_cursor,prev_cursor:e.prev_cursor,owner_records:[],records:[]};return null!=e.owner_records&&e.owner_records.forEach((e=>{t.owner_records.push({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,rank:e.rank?Number(e.rank):0,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0})})),null!=e.records&&e.records.forEach((e=>{t.records.push({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,rank:e.rank?Number(e.rank):0,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0})})),Promise.resolve(t)}))}))}listMatches(e,t,r,s,n,i,o){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listMatches(e.token,t,r,s,n,i,o)}))}listNotifications(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listNotifications(e.token,t,r).then((e=>{var t={cacheable_cursor:e.cacheable_cursor,notifications:[]};return null==e.notifications||e.notifications.forEach((e=>{t.notifications.push({code:e.code?Number(e.code):0,create_time:e.create_time,id:e.id,persistent:e.persistent,sender_id:e.sender_id,subject:e.subject,content:e.content?JSON.parse(e.content):void 0})})),Promise.resolve(t)}))}))}listStorageObjects(e,t,r,s,n){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listStorageObjects(e.token,t,r,s,n).then((e=>{var t={objects:[],cursor:e.cursor};return null==e.objects||e.objects.forEach((e=>{t.objects.push({collection:e.collection,key:e.key,permission_read:e.permission_read?Number(e.permission_read):0,permission_write:e.permission_write?Number(e.permission_write):0,value:e.value?JSON.parse(e.value):void 0,version:e.version,user_id:e.user_id,create_time:e.create_time,update_time:e.update_time})})),Promise.resolve(t)}))}))}listTournaments(e,t,r,s,n,i,o){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listTournaments(e.token,t,r,s,n,i,o).then((e=>{var t={cursor:e.cursor,tournaments:[]};return null!=e.tournaments&&e.tournaments.forEach((e=>{t.tournaments.push({id:e.id,title:e.title,description:e.description,duration:e.duration?Number(e.duration):0,category:e.category?Number(e.category):0,sort_order:e.sort_order?Number(e.sort_order):0,size:e.size?Number(e.size):0,max_size:e.max_size?Number(e.max_size):0,max_num_score:e.max_num_score?Number(e.max_num_score):0,can_enter:e.can_enter,end_active:e.end_active?Number(e.end_active):0,next_reset:e.next_reset?Number(e.next_reset):0,metadata:e.metadata?JSON.parse(e.metadata):void 0,create_time:e.create_time,start_time:e.start_time,end_time:e.end_time,start_active:e.start_active})})),Promise.resolve(t)}))}))}listTournamentRecords(e,t,r,s,n,i){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listTournamentRecords(e.token,t,r,s,n,i).then((e=>{var t={next_cursor:e.next_cursor,prev_cursor:e.prev_cursor,owner_records:[],records:[]};return null!=e.owner_records&&e.owner_records.forEach((e=>{t.owner_records.push({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,rank:e.rank?Number(e.rank):0,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0})})),null!=e.records&&e.records.forEach((e=>{t.records.push({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,rank:e.rank?Number(e.rank):0,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0})})),Promise.resolve(t)}))}))}listTournamentRecordsAroundOwner(e,t,r,s,n){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.listTournamentRecordsAroundOwner(e.token,t,r,s,n).then((e=>{var t={next_cursor:e.next_cursor,prev_cursor:e.prev_cursor,owner_records:[],records:[]};return null!=e.owner_records&&e.owner_records.forEach((e=>{t.owner_records.push({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,rank:e.rank?Number(e.rank):0,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0})})),null!=e.records&&e.records.forEach((e=>{t.records.push({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,rank:e.rank?Number(e.rank):0,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0})})),Promise.resolve(t)}))}))}promoteGroupUsers(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.promoteGroupUsers(e.token,t,r)}))}readStorageObjects(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.readStorageObjects(e.token,t).then((e=>{var t={objects:[]};return null==e.objects||e.objects.forEach((e=>{t.objects.push({collection:e.collection,key:e.key,permission_read:e.permission_read?Number(e.permission_read):0,permission_write:e.permission_write?Number(e.permission_write):0,value:e.value?JSON.parse(e.value):void 0,version:e.version,user_id:e.user_id,create_time:e.create_time,update_time:e.update_time})})),Promise.resolve(t)}))}))}rpc(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.rpcFunc(e.token,t,JSON.stringify(r)).then((e=>Promise.resolve({id:e.id,payload:e.payload?JSON.parse(e.payload):void 0})))}))}rpcHttpKey(e,t,r){return j(this,null,(function*(){return this.apiClient.rpcFunc2("",t,r&&JSON.stringify(r)||"",e).then((e=>Promise.resolve({id:e.id,payload:e.payload?JSON.parse(e.payload):void 0}))).catch((e=>{throw e}))}))}sessionLogout(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.sessionLogout(e.token,{refresh_token:r,token:t}).then((e=>void 0!==e))}))}sessionRefresh(e){return j(this,arguments,(function*(e,t={}){if(!e)return console.error("Cannot refresh a null session."),e;e.created&&e.expires_at-e.created_at<70&&console.warn("Session lifetime too short, please set '--session.token_expiry_sec' option. See the documentation for more info: https://heroiclabs.com/docs/nakama/getting-started/configuration/#session"),e.created&&e.refresh_expires_at-e.created_at<3700&&console.warn("Session refresh lifetime too short, please set '--session.refresh_token_expiry_sec' option. See the documentation for more info: https://heroiclabs.com/docs/nakama/getting-started/configuration/#session");const r=yield this.apiClient.sessionRefresh(this.serverkey,"",{token:e.refresh_token,vars:t});return e.update(r.token,r.refresh_token),e}))}unlinkApple(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.unlinkApple(e.token,t).then((e=>void 0!==e))}))}unlinkCustom(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.unlinkCustom(e.token,t).then((e=>void 0!==e))}))}unlinkDevice(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.unlinkDevice(e.token,t).then((e=>void 0!==e))}))}unlinkEmail(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.unlinkEmail(e.token,t).then((e=>void 0!==e))}))}unlinkFacebook(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.unlinkFacebook(e.token,t).then((e=>void 0!==e))}))}unlinkFacebookInstantGame(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.unlinkFacebookInstantGame(e.token,t).then((e=>void 0!==e))}))}unlinkGoogle(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.unlinkGoogle(e.token,t).then((e=>void 0!==e))}))}unlinkGameCenter(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.unlinkGameCenter(e.token,t).then((e=>void 0!==e))}))}unlinkSteam(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.unlinkSteam(e.token,t).then((e=>void 0!==e))}))}updateAccount(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.updateAccount(e.token,t).then((e=>void 0!==e))}))}updateGroup(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.updateGroup(e.token,t,r).then((e=>void 0!==e))}))}validatePurchaseApple(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.validatePurchaseApple(e.token,{receipt:t})}))}validatePurchaseGoogle(e,t){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.validatePurchaseGoogle(e.token,{purchase:t})}))}validatePurchaseHuawei(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.validatePurchaseHuawei(e.token,{purchase:t,signature:r})}))}writeLeaderboardRecord(e,t,r){return j(this,null,(function*(){return this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e)),this.apiClient.writeLeaderboardRecord(e.token,t,{metadata:r.metadata?JSON.stringify(r.metadata):void 0,score:r.score,subscore:r.subscore}).then((e=>Promise.resolve({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0,rank:e.rank?Number(e.rank):0})))}))}writeStorageObjects(e,t){return j(this,null,(function*(){this.autoRefreshSession&&e.refresh_token&&e.isexpired((Date.now()+this.expiredTimespanMs)/1e3)&&(yield this.sessionRefresh(e));var r={objects:[]};return t.forEach((e=>{r.objects.push({collection:e.collection,key:e.key,permission_read:e.permission_read,permission_write:e.permission_write,value:JSON.stringify(e.value),version:e.version})})),this.apiClient.writeStorageObjects(e.token,r)}))}writeTournamentRecord(e,t,r){return j(this,null,(function*(){return this.apiClient.writeTournamentRecord(e.token,t,{metadata:r.metadata?JSON.stringify(r.metadata):void 0,score:r.score,subscore:r.subscore}).then((e=>Promise.resolve({expiry_time:e.expiry_time,leaderboard_id:e.leaderboard_id,metadata:e.metadata?JSON.parse(e.metadata):void 0,num_score:e.num_score?Number(e.num_score):0,owner_id:e.owner_id,score:e.score?Number(e.score):0,subscore:e.subscore?Number(e.subscore):0,update_time:e.update_time,username:e.username,max_num_score:e.max_num_score?Number(e.max_num_score):0,rank:e.rank?Number(e.rank):0})))}))}}("defaultkey","localhost","7350"),this.client.ssl=!1;let e=localStorage.getItem("deviceId");e||(e=pe(),localStorage.setItem("deviceId",e)),this.session=await this.client.authenticateDevice(e,!0),localStorage.setItem("user_id",this.session.user_id);this.socket=this.client.createSocket(this.useSSL,!1),await this.socket.connect(this.session)}async findMatch(e=!1){const t=await this.client.rpc(this.session,"find_match_js",{ai:e});this.matchID=t.payload.matchIds[0],await this.socket.joinMatch(this.matchID),console.log("Matched joined!")}async makeMove(e){var t={position:e};await this.socket.sendMatchState(this.matchID,4,JSON.stringify(t)),console.log("Match data sent: ",t)}async inviteAI(){await this.socket.sendMatchState(this.matchID,7,""),console.log("AI player invited")}};class _e extends Phaser.Scene{constructor(){super("main-menu")}create(){fe.authenticate(),this.add.text(P/2,75,"Welcome to",{fontFamily:"Arial",fontSize:"24px"}).setOrigin(.5),this.add.text(P/2,123,"XOXO",{fontFamily:"Arial",fontSize:"72px"}).setOrigin(.5),this.add.grid(P/2,S/2,300,300,100,100,16777215,0,16763431);const e=this.add.rectangle(P/2,600,225,70,16763431).setInteractive({useHandCursor:!0}),t=this.add.text(P/2,600,"Find match",{fontFamily:"Arial",fontSize:"36px"}).setOrigin(.5);e.on("pointerdown",(()=>{fe.findMatch(),this.scene.start("in-game")})),e.on("pointerover",(()=>{e.setScale(1.1),t.setScale(1.1)})),e.on("pointerout",(()=>{e.setScale(1),t.setScale(1)}));const r=this.add.rectangle(P/2,680,225,70,16763431).setInteractive({useHandCursor:!0}),s=this.add.text(P/2,680,"Play with AI",{fontFamily:"Arial",fontSize:"36px"}).setOrigin(.5);r.on("pointerdown",(()=>{fe.findMatch(!0),this.scene.start("in-game",!0)})),r.on("pointerover",(()=>{r.setScale(1.1),s.setScale(1.1)})),r.on("pointerout",(()=>{r.setScale(1),s.setScale(1)}))}}class we extends Phaser.Scene{constructor(){super("matchmaking")}preload(){this.load.spritesheet("spinner","assets/loader-spritesheet.png",{frameWidth:200,frameHeight:200,endFrame:40})}create(){this.add.text(P/2,125,"Searching for an opponent...",{fontFamily:"Arial",fontSize:"24px"}).setOrigin(.5),this.anims.create({key:"spinnerAnimation",frames:this.anims.generateFrameNumbers("spinner"),frameRate:30,repeat:Phaser.FOREVER}),this.add.sprite(P/2,S/2,"spinner").play("spinnerAnimation").setScale(.5)}}class be extends Phaser.Scene{constructor(){super("in-game"),this.INDEX_TO_POS,this.headerText,this.gameStarted=!1,this.turn=!1,this.phaser=this,this.playerPos}updateBoard(e){e.forEach(((e,t)=>{let r=this.INDEX_TO_POS[t];1===e?this.phaser.add.image(r.x,r.y,"X"):2===e&&this.phaser.add.image(r.x,r.y,"O")}))}updatePlayerTurn(){this.playerTurn=!this.playerTurn,this.playerTurn?this.headerText.setText("Your turn!"):this.headerText.setText("Opponents turn!")}setPlayerTurn(e){let t=localStorage.getItem("user_id");console.log(t,e.marks),1===e.marks[t]?(this.playerTurn=!0,this.playerPos=1,this.headerText.setText("Your turn!")):(this.playerPos=2,this.headerText.setText("Opponents turn!"))}opponentLeft(){this.headerText.setText("Opponent has left"),this.playAIBtn.setVisible(!0),this.playAIBtnText.setVisible(!0)}endGame(e){this.updateBoard(e.board),e.winner===this.playerPos?this.headerText.setText("Winner!"):void 0===e.winner?this.headerText.setText("Tie!"):this.headerText.setText("You loose :(")}nakamaListener(){fe.socket.onmatchdata=e=>{const t=(new TextDecoder).decode(e.data),r=t?JSON.parse(t):"";switch(e.op_code){case 1:this.gameStarted=!0,this.setPlayerTurn(r);break;case 2:console.log(e.data),this.updateBoard(r.board),this.updatePlayerTurn();break;case 3:this.endGame(r);break;case 6:this.opponentLeft()}}}preload(){this.load.image("X","assets/X.png"),this.load.image("O","assets/O.png")}create(){this.headerText=this.add.text(P/2,125,"Waiting for game to start",{fontFamily:"Arial",fontSize:"36px"}).setOrigin(.5);const e=100,t=this.add.grid(P/2,S/2,300,300,e,e,16777215,0,16763431),r=t.getCenter().x,s=t.getCenter().y,n=s-e,i=s+e,o=r-e,a=r+e;this.INDEX_TO_POS={0:{x:o,y:n},1:{x:r,y:n},2:{x:a,y:n},3:{x:o,y:s},4:{x:r,y:s},5:{x:a,y:s},6:{x:o,y:i},7:{x:r,y:i},8:{x:a,y:i}},this.nakamaListener(),this.add.rectangle(r-e,n,e,e).setInteractive({useHandCursor:!0}).on("pointerdown",(async()=>{await fe.makeMove(0)})),this.add.rectangle(r,n,e,e).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{fe.makeMove(1)})),this.add.rectangle(r+e,n,e,e).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{fe.makeMove(2)})),this.add.rectangle(r-e,s,e,e).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{fe.makeMove(3)})),this.add.rectangle(r,s,e,e).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{fe.makeMove(4)})),this.add.rectangle(r+e,s,e,e).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{fe.makeMove(5)})),this.add.rectangle(r-e,i,e,e).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{fe.makeMove(6)})),this.add.rectangle(r,i,e,e).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{fe.makeMove(7)})),this.add.rectangle(r+e,i,e,e).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{fe.makeMove(8)})),this.playAIBtn=this.add.rectangle(P/2,680,270,70,16763431).setVisible(!1).setInteractive({useHandCursor:!0}),this.playAIBtnText=this.add.text(P/2,680,"Continue with AI",{fontFamily:"Arial",fontSize:"36px"}).setVisible(!1).setOrigin(.5),this.playAIBtn.on("pointerdown",(async()=>{await fe.inviteAI(),this.playAIBtn.setVisible(!1),this.playAIBtnText.setVisible(!1)})),this.playAIBtn.on("pointerover",(()=>{this.playAIBtn.setScale(1.1),this.playAIBtnText.setScale(1.1)})),this.playAIBtn.on("pointerout",(()=>{this.playAIBtn.setScale(1),this.playAIBtnText.setScale(1)}))}}function ye(e){const t={type:Phaser.AUTO,width:P,height:S,backgroundColor:"#FF4C4C",autoCenter:!0,scene:[_e,we,be]};return new Phaser.Game(t),[]}return new class extends class{$destroy(){!function(e,t){const r=e.$$;null!==r.fragment&&(s(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){super(),v(this,e,ye,null,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
